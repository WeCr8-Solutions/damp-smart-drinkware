<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#0f0f23">

    <!-- Google Verification -->
    <meta name="google-site-verification" content="HpQSlyxLgJ-xsYz8b1qiYIiI35zG9toHSrvPHpbLHBI">
    <meta name="google-adsense-account" content="ca-pub-3639153716376265">

    <!-- Enhanced Security Meta Tags -->
    <!-- CSP disabled for local development - Netlify adds its own CSP in production -->
    <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://js.stripe.com https://checkout.stripe.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: https://www.googletagmanager.com; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https://js.stripe.com https://checkout.stripe.com; connect-src 'self' https://api.stripe.com https://checkout.stripe.com https://dampdrink.com;"> -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <!-- X-Frame-Options should be set via HTTP headers, not meta tags -->
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains">

    <!-- Favicon Links -->
    <link rel="icon" type="image/x-icon" href="../assets/images/logo/favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="../assets/images/logo/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/images/logo/icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/images/logo/icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/images/logo/icon.png">

    <!-- Prevent PWA installation prompts -->
    <meta name="mobile-web-app-capable" content="no">
    <meta name="apple-mobile-web-app-capable" content="no">

    <!-- SEO Meta Tags - Pre-Sale Optimized -->
    <title>Reserve DAMP Smart Cup Accessory - Help Us Reach 500 to Start Production</title>
    <meta name="description" content="Reserve your DAMP device today! We need 500 reservations to begin production. Be an early supporter and lock in exclusive early-bird pricing.">
    <meta name="keywords" content="smart cup accessory, reserve now, crowdfunding, early access, never lose drink, clip-on tracker, Stanley, Hydro Flask, Yeti">
    <meta name="author" content="WeCr8 Solutions LLC">
    <meta name="robots" content="index, follow, max-image-preview:large">
    <link rel="canonical" href="https://dampdrink.com/pages/pre-sale-funnel.html">

    <!-- Open Graph -->
    <meta property="og:type" content="product">
    <meta property="og:url" content="https://dampdrink.com/pages/pre-sale-funnel.html">
    <meta property="og:title" content="Reserve DAMP Smart Cup Accessory - 500 Needed to Start Production">
    <meta property="og:description" content="Help us reach 500 reservations to begin production. Reserve yours today and lock in early-bird pricing.">
    <meta property="og:image" content="https://dampdrink.com/assets/images/og-presale.jpg">
    <meta property="og:site_name" content="DAMP Smart Drinkware">

    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preconnect" href="https://js.stripe.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">

    <!-- Load Stripe.js early to ensure it's available -->
    <script src="https://js.stripe.com/v3/" async></script>

    <!-- CSS Architecture -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/navigation.css">
    <link rel="stylesheet" href="../assets/css/components/cookie-consent.css">

    <!-- Pre-Sale Specific Styles -->
    <style>
        /* Pre-Sale Funnel Specific Styles */
        :root {
            --presale-accent: #ff4757;
            --presale-success: #0f8;
            --presale-warning: #ffa502;
            --urgency-pulse: #ff3838;
        }

        .presale-body {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .presale-hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 120px 20px 60px;
            position: relative;
            overflow: hidden;
        }

        .presale-hero::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 50% 50%, rgb(0 212 255 / 10%) 0%, transparent 50%);
            pointer-events: none;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            z-index: 2;
            position: relative;
        }

        .presale-badge {
            display: inline-block;
            background: linear-gradient(45deg, var(--presale-accent), #ff6b6b);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        .hero-title {
            font-size: clamp(2.5rem, 8vw, 4rem);
            font-weight: 900;
            background: linear-gradient(45deg, #fff, #00d4ff);
            background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            line-height: 1.1;
        }

        .hero-subtitle {
            font-size: clamp(1.1rem, 3vw, 1.4rem);
            color: rgb(255 255 255 / 90%);
            margin-bottom: 40px;
            line-height: 1.4;
        }

        .goal-counter {
            background: rgb(255 255 255 / 10%);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin: 40px 0;
            border: 1px solid rgb(255 255 255 / 20%);
        }

        .counter-title {
            font-size: 1.2rem;
            color: var(--presale-success);
            font-weight: bold;
            margin-bottom: 15px;
        }

        .progress-container {
            margin: 20px 0;
        }

        .progress-numbers {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .current-count {
            font-size: 2rem;
            font-weight: bold;
            color: var(--presale-success);
        }

        .goal-count {
            font-size: 1.2rem;
            color: rgb(255 255 255 / 70%);
        }

        .progress-bar-container {
            width: 100%;
            height: 12px;
            background: rgb(255 255 255 / 20%);
            border-radius: 6px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--presale-success), #00d4ff);
            border-radius: 6px;
            transition: width 1s ease;
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgb(255 255 255 / 30%), transparent);
            animation: shimmer 2s infinite;
        }

        .countdown-timer {
            background: linear-gradient(45deg, var(--presale-accent), #ff6b6b);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .countdown-label {
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .countdown-display {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .countdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }

        .countdown-number {
            font-size: 1.8rem;
            font-weight: bold;
            line-height: 1;
        }

        .countdown-unit {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.8;
        }

        .cta-primary {
            display: inline-block;
            background: linear-gradient(45deg, #00d4ff, #09c);
            color: white;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            text-decoration: none;
            transition: all 0.3s ease;
            margin: 20px 0;
            box-shadow: 0 8px 25px rgb(0 212 255 / 30%);
        }

        .cta-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgb(0 212 255 / 40%);
        }

        .problem-solution {
            padding: 100px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            font-size: clamp(2rem, 5vw, 3rem);
            text-align: center;
            background: linear-gradient(45deg, #fff, #00d4ff);
            background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 60px;
            font-weight: bold;
        }

        .problem-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-bottom: 80px;
        }

        .problem-card, .solution-card {
            background: rgb(255 255 255 / 10%);
            border-radius: 20px;
            padding: 40px 30px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgb(255 255 255 / 10%);
            transition: all 0.3s ease;
        }

        .problem-card {
            border-left: 4px solid var(--presale-accent);
        }

        .solution-card {
            border-left: 4px solid var(--presale-success);
        }

        .problem-card:hover, .solution-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgb(0 0 0 / 30%);
        }

        .card-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #fff;
        }

        .card-description {
            color: rgb(255 255 255 / 80%);
            line-height: 1.6;
        }

        .how-it-works {
            padding: 100px 20px;
            background: rgb(255 255 255 / 5%);
            backdrop-filter: blur(10px);
        }

        .steps-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-top: 60px;
        }

        .step-card {
            text-align: center;
            position: relative;
        }

        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #00d4ff, #09c);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0 auto 20px;
            color: white;
        }

        .step-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #00d4ff;
        }

        .step-description {
            color: rgb(255 255 255 / 80%);
            line-height: 1.6;
        }

        .social-proof {
            padding: 100px 20px;
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .testimonials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 60px 0;
        }

        .testimonial-card {
            background: rgb(255 255 255 / 10%);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgb(255 255 255 / 10%);
        }

        .testimonial-text {
            font-style: italic;
            margin-bottom: 20px;
            color: rgb(255 255 255 / 90%);
            line-height: 1.6;
        }

        .testimonial-author {
            font-weight: bold;
            color: var(--presale-success);
        }

        .testimonial-role {
            font-size: 0.9rem;
            color: rgb(255 255 255 / 60%);
        }

        .final-cta {
            padding: 100px 20px;
            background: linear-gradient(135deg, rgb(0 212 255 / 10%), rgb(255 71 87 / 10%));
            text-align: center;
        }

        .cta-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .recent-activity {
            background: rgb(0 255 136 / 20%);
            border: 1px solid var(--presale-success);
            border-radius: 10px;
            padding: 15px;
            margin: 30px 0;
            font-size: 0.9rem;
            color: var(--presale-success);
            font-weight: bold;
        }

        .live-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--presale-success);
            border-radius: 50%;
            margin-right: 8px;
            animation: blink 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* Product card hover effects */
        .product-card {
            transition: all 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgb(0 0 0 / 30%);
        }

        /* Button hover effects */
        .qty-btn:hover, .add-to-cart-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgb(0 212 255 / 30%);
        }

        /* Responsive Design */
        @media (width <= 768px) {
            .presale-hero {
                padding: 100px 15px 40px;
            }

            .goal-counter {
                padding: 20px;
                margin: 30px 0;
            }

            .progress-numbers {
                flex-direction: column;
                gap: 10px;
            }

            .countdown-display {
                gap: 10px;
            }

            .countdown-item {
                min-width: 50px;
            }

            .problem-solution, .how-it-works, .social-proof, .final-cta {
                padding: 60px 15px;
            }

            .cta-primary {
                padding: 15px 30px;
                font-size: 1.1rem;
            }
        }
    </style>

    <!-- Security Scripts -->
    <script src="../assets/js/security-utils.js"></script>

    <!-- Analytics -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', {
            'analytics_storage': 'denied',
            'ad_storage': 'denied',
            'functionality_storage': 'denied',
            'personalization_storage': 'denied',
            'security_storage': 'granted'
        });
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID', {
            page_title: 'DAMP Pre-Sale Funnel',
            send_page_view: false
        });
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="DAMP">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#1a1a2e">
    <meta name="msapplication-tap-highlight" content="no">

    <!-- PWA Theme Colors -->
    <meta name="theme-color" content="#00d4ff" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#1a1a2e" media="(prefers-color-scheme: dark)">

    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/logo/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/logo/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/assets/images/logo/icon-48.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/images/logo/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/assets/images/logo/icon-512.png">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/logo/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/images/logo/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/images/logo/icon-72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/images/logo/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/images/logo/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/images/logo/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/images/logo/icon-144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/logo/icon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/logo/apple-icon-180x180.png"></head>

<body class="presale-body">
    <!-- DAMP Header Component with Hamburger Navigation -->
    <damp-header></damp-header>

    <!-- Hero Section with Goal Counter -->
    <section class="presale-hero" id="main-content">
        <div class="hero-content">
            <div class="presale-badge">
                üéØ RESERVATION CAMPAIGN LIVE
            </div>

            <h1 class="hero-title">
                Turn Your Favorite Cup Smart ‚Äì Never Lose It Again
            </h1>

            <p class="hero-subtitle">
                Clip-on accessory for Stanley, Hydro Flask, and more ‚Äì Reserve yours today and help us reach our 500-unit production goal.
            </p>

            <!-- Reservation Goal Counter -->
            <div class="goal-counter">
                <div class="counter-title">
                    <span class="live-indicator"></span>
                    <span id="current-backers">0</span> of 500 Reservations
                </div>
                
                <div style="text-align: center; margin-top: 15px; padding: 15px; background: rgb(255 255 255 / 5%); border-radius: 10px; border: 1px solid rgb(0 212 255 / 20%);">
                    <p style="font-size: 0.95rem; color: rgb(0 212 255 / 90%); margin: 0;">
                        <strong>üì¶ Production Starts at 500 Reservations</strong><br>
                        <span style="font-size: 0.85rem; color: rgb(255 255 255 / 70%);">
                            Reserve now to lock in early-bird pricing and be first in line when we ship
                        </span>
                    </p>
                </div>

                <div class="progress-container" style="display: none;">
                    <div class="progress-numbers">
                        <span class="current-count" id="progress-count">0</span>
                        <span class="goal-count">Reservations</span>
                    </div>

                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Early Bird Pricing Badge -->
                <div style="display: inline-block; padding: 10px 20px; background: linear-gradient(45deg, #ffa502, #ff6348); border-radius: 25px; margin-bottom: 20px; box-shadow: 0 4px 15px rgb(255 165 2 / 40%);">
                    <span style="font-size: 1.1rem; font-weight: bold; color: white;">üéØ EARLY BIRD PRICING ACTIVE</span>
                </div>

                <!-- Countdown Timer -->
                <div class="countdown-timer">
                    <div class="countdown-label">‚è∞ Early Bird Pricing Ends:</div>
                    <div class="countdown-display">
                        <div class="countdown-item">
                            <span class="countdown-number" id="days">6</span>
                            <span class="countdown-unit">Days</span>
                        </div>
                        <div class="countdown-item">
                            <span class="countdown-number" id="hours">14</span>
                            <span class="countdown-unit">Hours</span>
                        </div>
                        <div class="countdown-item">
                            <span class="countdown-number" id="minutes">37</span>
                            <span class="countdown-unit">Minutes</span>
                        </div>
                        <div class="countdown-item">
                            <span class="countdown-number" id="seconds">28</span>
                            <span class="countdown-unit">Seconds</span>
                        </div>
                    </div>
                </div>
            </div>

            <a href="#checkout" class="cta-primary" data-analytics="hero-cta">
                Reserve Your Spot
            </a>

            <div class="recent-activity" style="display: none;">
                <span class="live-indicator"></span>
                <span id="recent-activity-text">Be one of the first to reserve!</span>
            </div>
        </div>
    </section>

    <!-- Problem & Solution Section -->
    <section class="problem-solution">
        <h2 class="section-title">The Problem We're Solving</h2>

        <div class="problem-grid">
            <div class="problem-card">
                <span class="card-icon">üò´</span>
                <h3 class="card-title">You Keep Losing Your Drinks</h3>
                <p class="card-description">
                    Left your Stanley at the coffee shop? Forgot your Hydro Flask at the gym?
                    We've all been there ‚Äì expensive drinks abandoned everywhere.
                </p>
            </div>

            <div class="solution-card">
                <span class="card-icon">üì±</span>
                <h3 class="card-title">Smart Phone Alerts</h3>
                <p class="card-description">
                    DAMP clips onto any cup and alerts your phone when you're about to leave it behind.
                    Works with Stanley, Hydro Flask, Yeti, and more.
                </p>
            </div>
        </div>

        <div style="text-align: center; margin-top: 40px;">
            <p style="font-size: 1.2rem; color: rgb(255 255 255 / 90%);">
                <strong>Works with Stanley, Hydro Flask, Yeti, and virtually any cup or bottle</strong>
            </p>
        </div>
    </section>

    <!-- How It Works Section -->
    <section class="how-it-works">
        <div class="steps-container">
            <h2 class="section-title">How DAMP Works</h2>
            <p style="text-align: center; font-size: 1.2rem; color: rgb(255 255 255 / 80%); margin-bottom: 40px;">
                Three simple steps to never lose your drink again
            </p>

            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3 class="step-title">Clip DAMP Onto Your Cup</h3>
                    <p class="step-description">
                        Universal clip design works with Stanley tumblers, Hydro Flask bottles,
                        Yeti mugs, and virtually any drinkware. Installs in seconds.
                    </p>
                </div>

                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3 class="step-title">Pair With Phone Via App</h3>
                    <p class="step-description">
                        Download the DAMP app and pair your device via Bluetooth.
                        Simple one-time setup works with iOS and Android.
                    </p>
                </div>

                <div class="step-card">
                    <div class="step-number">3</div>
                    <h3 class="step-title">Get Notified Before You Lose It</h3>
                    <p class="step-description">
                        Walk away from your drink? Get an instant alert on your phone
                        before you leave it behind. Never lose another cup.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Product Selection & Cart Section -->
    <section class="final-cta" id="checkout">
        <div class="cta-container">
            <h2 class="section-title">Choose Your DAMP Products</h2>

            <p style="font-size: 1.2rem; color: rgb(255 255 255 / 90%); margin-bottom: 15px;">
                <strong>Reserve your devices now</strong> and help us reach our production goals. Lock in early-bird pricing today!
            </p>
            
            <div style="text-align: center; margin-bottom: 30px; padding: 15px; background: rgb(255 255 255 / 5%); border-radius: 10px; border: 1px solid rgb(0 212 255 / 20%);">
                <p style="font-size: 0.95rem; color: rgb(0 212 255 / 90%); margin: 0;">
                    <strong>üì¶ Each product needs 500 reservations to begin production</strong><br>
                    <span style="font-size: 0.85rem; color: rgb(255 255 255 / 70%);">
                        Products that reach the goal first will be manufactured and shipped first
                    </span>
                </p>
            </div>

            <!-- Product Selection Grid -->
            <div class="product-selection-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 40px 0;">

                <!-- DAMP Cup Sleeve (PRIMARY PRODUCT) -->
                <div class="product-card" data-product="cup-sleeve" style="border: 2px solid rgb(255 165 2 / 50%); box-shadow: 0 0 20px rgb(255 165 2 / 30%);">
                    <div style="background: linear-gradient(45deg, #ffa502, #ff6348); color: white; padding: 5px; border-radius: 10px 10px 0 0; margin: -15px -15px 15px -15px; text-align: center; font-weight: bold; font-size: 0.85rem;">
                        ‚≠ê MOST POPULAR
                    </div>
                    <div class="product-image" style="height: 200px; background: linear-gradient(135deg, #ffa502, #ff6348); border-radius: 15px; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; padding: 20px; pointer-events: none;">
                        <picture style="max-width: 100%; max-height: 100%; display: flex; align-items: center; justify-content: center;">
                            <source 
                                type="image/avif" 
                                srcset="../assets/images/optimized/products/cup-sleeve/cup-sleeve-medium.avif 400w, ../assets/images/optimized/products/cup-sleeve/cup-sleeve-large.avif 800w"
                                sizes="(max-width: 768px) 400px, 800px">
                            <source 
                                type="image/webp" 
                                srcset="../assets/images/optimized/products/cup-sleeve/cup-sleeve-medium.webp 400w, ../assets/images/optimized/products/cup-sleeve/cup-sleeve-large.webp 800w"
                                sizes="(max-width: 768px) 400px, 800px">
                            <img src="../assets/images/optimized/products/cup-sleeve/cup-sleeve-medium.png" alt="DAMP Cup Sleeve" style="max-width: 100%; max-height: 100%; object-fit: contain; filter: drop-shadow(0 4px 8px rgb(0 0 0 / 30%)); pointer-events: none;">
                        </picture>
                    </div>
                    <h3 class="product-title" style="color: white; font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">DAMP Cup Sleeve</h3>
                    
                    <!-- Product Goal Counter -->
                    <div style="margin-bottom: 15px; padding: 10px; background: rgb(255 165 2 / 10%); border-radius: 8px; border: 1px solid rgb(255 165 2 / 30%);">
                        <div style="font-size: 0.85rem; color: rgb(255 255 255 / 80%); margin-bottom: 5px;">
                            <span class="product-goal-count" data-product="cup-sleeve">0</span> / 500 Reserved
                        </div>
                        <div style="background: rgb(255 255 255 / 20%); height: 6px; border-radius: 3px; overflow: hidden;">
                            <div class="product-goal-bar" data-product="cup-sleeve" style="width: 0%; height: 100%; background: linear-gradient(45deg, #ffa502, #ff6348); transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                    
                    <div class="product-pricing" style="margin-bottom: 15px;">
                        <span class="current-price" style="color: var(--presale-success); font-size: 1.4rem; font-weight: bold;">$34.99</span>
                        <span class="original-price" style="color: rgb(255 255 255 / 60%); text-decoration: line-through; margin-left: 10px;">$44.99</span>
                    </div>
                    <p class="product-description" style="color: rgb(255 255 255 / 80%); font-size: 0.9rem; margin-bottom: 20px;">Smart sleeve for coffee cups and smaller drinkware. Works with most standard cups.</p>

                    <div class="quantity-controls" style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 15px;">
                        <button class="qty-btn minus" data-product="cup-sleeve" style="width: 40px; height: 40px; border: none; background: rgb(255 255 255 / 20%); color: white; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">-</button>
                        <span class="quantity" data-product="cup-sleeve" style="color: white; font-size: 1.2rem; font-weight: bold; min-width: 30px; text-align: center;">0</span>
                        <button class="qty-btn plus" data-product="cup-sleeve" style="width: 40px; height: 40px; border: none; background: rgb(255 255 255 / 20%); color: white; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">+</button>
                    </div>

                    <button class="add-to-cart-btn" data-product-id="cup-sleeve" data-product-name="DAMP Cup Sleeve" data-product-price="34.99" style="width: 100%; background: linear-gradient(45deg, var(--presale-success), #00d4ff); color: white; border: none; padding: 12px; border-radius: 25px; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                        Add to Cart
                    </button>
                </div>

                <!-- DAMP Silicone Bottom -->
                <div class="product-card" data-product="silicone-bottom">
                    <div class="product-image" style="height: 200px; background: linear-gradient(135deg, #00d4ff, #09c); border-radius: 15px; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; padding: 20px; pointer-events: none;">
                        <picture style="max-width: 100%; max-height: 100%; display: flex; align-items: center; justify-content: center;">
                            <source 
                                type="image/avif" 
                                srcset="../assets/images/optimized/products/silicone-bottom/silicone-bottom-medium.avif 400w, ../assets/images/optimized/products/silicone-bottom/silicone-bottom-large.avif 800w"
                                sizes="(max-width: 768px) 400px, 800px">
                            <source 
                                type="image/webp" 
                                srcset="../assets/images/optimized/products/silicone-bottom/silicone-bottom-medium.webp 400w, ../assets/images/optimized/products/silicone-bottom/silicone-bottom-large.webp 800w"
                                sizes="(max-width: 768px) 400px, 800px">
                            <img src="../assets/images/optimized/products/silicone-bottom/silicone-bottom-medium.png" alt="DAMP Silicone Bottom" style="max-width: 100%; max-height: 100%; object-fit: contain; filter: drop-shadow(0 4px 8px rgb(0 0 0 / 30%)); pointer-events: none;">
                        </picture>
                    </div>
                    <h3 class="product-title" style="color: white; font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">DAMP Silicone Bottom</h3>
                    
                    <!-- Product Goal Counter -->
                    <div style="margin-bottom: 15px; padding: 10px; background: rgb(0 212 255 / 10%); border-radius: 8px; border: 1px solid rgb(0 212 255 / 30%);">
                        <div style="font-size: 0.85rem; color: rgb(255 255 255 / 80%); margin-bottom: 5px;">
                            <span class="product-goal-count" data-product="silicone-bottom">0</span> / 500 Reserved
                        </div>
                        <div style="background: rgb(255 255 255 / 20%); height: 6px; border-radius: 3px; overflow: hidden;">
                            <div class="product-goal-bar" data-product="silicone-bottom" style="width: 0%; height: 100%; background: linear-gradient(45deg, #00d4ff, #09c); transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                    
                    <div class="product-pricing" style="margin-bottom: 15px;">
                        <span class="current-price" style="color: var(--presale-success); font-size: 1.4rem; font-weight: bold;">$29.99</span>
                        <span class="original-price" style="color: rgb(255 255 255 / 60%); text-decoration: line-through; margin-left: 10px;">$39.99</span>
                    </div>
                    <p class="product-description" style="color: rgb(255 255 255 / 80%); font-size: 0.9rem; margin-bottom: 20px;">Smart temperature monitoring silicone bottom for any cup or bottle.</p>

                    <div class="quantity-controls" style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 15px;">
                        <button class="qty-btn minus" data-product="silicone-bottom" style="width: 40px; height: 40px; border: none; background: rgb(255 255 255 / 20%); color: white; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">-</button>
                        <span class="quantity" data-product="silicone-bottom" style="color: white; font-size: 1.2rem; font-weight: bold; min-width: 30px; text-align: center;">0</span>
                        <button class="qty-btn plus" data-product="silicone-bottom" style="width: 40px; height: 40px; border: none; background: rgb(255 255 255 / 20%); color: white; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">+</button>
                    </div>

                    <button class="add-to-cart-btn" data-product-id="silicone-bottom" data-product-name="DAMP Silicone Bottom" data-product-price="29.99" style="width: 100%; background: linear-gradient(45deg, var(--presale-success), #00d4ff); color: white; border: none; padding: 12px; border-radius: 25px; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                        Add to Cart
                    </button>
                </div>

                <!-- DAMP Handle v1.0 -->
                <div class="product-card" data-product="damp-handle">
                    <div class="product-image" style="height: 200px; background: linear-gradient(135deg, #ff4757, #ff6b6b); border-radius: 15px; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; padding: 20px; pointer-events: none;">
                        <picture style="max-width: 100%; max-height: 100%; display: flex; align-items: center; justify-content: center;">
                            <source 
                                type="image/avif" 
                                srcset="../assets/images/optimized/products/damp-handle/damp-handle-medium.avif 400w, ../assets/images/optimized/products/damp-handle/damp-handle-large.avif 800w"
                                sizes="(max-width: 768px) 400px, 800px">
                            <source 
                                type="image/webp" 
                                srcset="../assets/images/optimized/products/damp-handle/damp-handle-medium.webp 400w, ../assets/images/optimized/products/damp-handle/damp-handle-large.webp 800w"
                                sizes="(max-width: 768px) 400px, 800px">
                            <img src="../assets/images/optimized/products/damp-handle/damp-handle-medium.png" alt="DAMP Handle v1.0" style="max-width: 100%; max-height: 100%; object-fit: contain; filter: drop-shadow(0 4px 8px rgb(0 0 0 / 30%)); pointer-events: none;">
                        </picture>
                    </div>
                    <h3 class="product-title" style="color: white; font-size: 1.3rem; font-weight: bold; margin-bottom: 10px;">DAMP Handle v1.0</h3>
                    
                    <!-- Product Goal Counter -->
                    <div style="margin-bottom: 15px; padding: 10px; background: rgb(255 71 87 / 10%); border-radius: 8px; border: 1px solid rgb(255 71 87 / 30%);">
                        <div style="font-size: 0.85rem; color: rgb(255 255 255 / 80%); margin-bottom: 5px;">
                            <span class="product-goal-count" data-product="damp-handle">0</span> / 500 Reserved
                        </div>
                        <div style="background: rgb(255 255 255 / 20%); height: 6px; border-radius: 3px; overflow: hidden;">
                            <div class="product-goal-bar" data-product="damp-handle" style="width: 0%; height: 100%; background: linear-gradient(45deg, #ff4757, #ff6b6b); transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                    
                    <div class="product-pricing" style="margin-bottom: 15px;">
                        <span class="current-price" style="color: var(--presale-success); font-size: 1.4rem; font-weight: bold;">$49.99</span>
                        <span class="original-price" style="color: rgb(255 255 255 / 60%); text-decoration: line-through; margin-left: 10px;">$69.99</span>
                    </div>
                    <p class="product-description" style="color: rgb(255 255 255 / 80%); font-size: 0.9rem; margin-bottom: 20px;">Smart handle attachment for Stanley IceFlow and similar bottles.</p>

                    <div class="quantity-controls" style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 15px;">
                        <button class="qty-btn minus" data-product="damp-handle" style="width: 40px; height: 40px; border: none; background: rgb(255 255 255 / 20%); color: white; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">-</button>
                        <span class="quantity" data-product="damp-handle" style="color: white; font-size: 1.2rem; font-weight: bold; min-width: 30px; text-align: center;">0</span>
                        <button class="qty-btn plus" data-product="damp-handle" style="width: 40px; height: 40px; border: none; background: rgb(255 255 255 / 20%); color: white; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">+</button>
                    </div>

                    <button class="add-to-cart-btn" data-product-id="damp-handle" data-product-name="DAMP Handle v1.0" data-product-price="49.99" style="width: 100%; background: linear-gradient(45deg, var(--presale-success), #00d4ff); color: white; border: none; padding: 12px; border-radius: 25px; font-weight: bold; cursor: pointer; transition: all 0.3s ease;">
                        Add to Cart
                    </button>
                </div>
            </div>

            <!-- Cart Summary -->
            <div class="cart-summary" id="cart-summary" style="background: rgb(255 255 255 / 10%); backdrop-filter: blur(20px); border-radius: 20px; padding: 30px; margin: 40px 0; border: 1px solid rgb(255 255 255 / 20%); display: none;">
                <h3 style="color: white; font-size: 1.4rem; font-weight: bold; margin-bottom: 20px; text-align: center;">üõí Your Cart</h3>
                <div id="cart-items" style="margin-bottom: 20px;"></div>
                <div class="cart-total" style="border-top: 1px solid rgb(255 255 255 / 30%); padding-top: 15px; text-align: center;">
                    <div style="color: rgb(255 255 255 / 80%); margin-bottom: 5px;">
                        Items: <span id="cart-item-count">0</span>
                    </div>
                    <div style="color: var(--presale-success); font-size: 1.6rem; font-weight: bold;">
                        Total: $<span id="cart-total">0.00</span>
                    </div>
                    <div style="color: rgb(255 255 255 / 60%); font-size: 0.9rem; margin-top: 5px;">
                        You save: $<span id="cart-savings">0.00</span>
                    </div>
                </div>
            </div>

            <!-- Sales Counter - Real Data Only -->
            <div class="goal-counter" style="display: none;">
                <div class="progress-container">
                    <div class="progress-numbers">
                        <span class="current-count" id="final-progress-count">0</span>
                        <span class="goal-count">Reservations</span>
                    </div>
                </div>
            </div>

            <button class="cta-primary" data-analytics="final-cta" id="checkout-button" style="opacity: 0.5; cursor: not-allowed;" disabled>
                Add Items to Cart First
            </button>
            
            <!-- Disclaimer Button -->
            <a href="#disclaimer-section" style="display: inline-block; margin-top: 15px; padding: 12px 30px; background: rgb(255 255 255 / 10%); color: rgb(255 255 255 / 80%); text-decoration: none; border-radius: 25px; font-size: 0.9rem; font-weight: 500; border: 1px solid rgb(255 255 255 / 20%); transition: all 0.3s ease;" onmouseover="this.style.background='rgb(255 255 255 / 20%)'; this.style.borderColor='rgb(255 255 255 / 40%)'" onmouseout="this.style.background='rgb(255 255 255 / 10%)'; this.style.borderColor='rgb(255 255 255 / 20%)'">
                ‚ö†Ô∏è Read Important Product Disclaimer
            </a>

            <p style="font-size: 0.9rem; color: rgb(255 255 255 / 70%); margin-top: 20px;">
                üîí Secure reservation via Stripe<br>
                üí≥ All major cards accepted ‚Ä¢ Reserve your spot today
            </p>

            <div class="recent-activity" style="margin-top: 30px; display: none;">
                <span class="live-indicator"></span>
                <span id="final-activity-text">Secure your reservation today!</span>
            </div>
        </div>
    </section>

    <!-- Newsletter Signup Section -->
    <section style="background: linear-gradient(135deg, rgb(0 212 255 / 10%), rgb(153 0 255 / 10%)); padding: 60px 20px; text-align: center; border-top: 1px solid rgb(255 255 255 / 10%); border-bottom: 1px solid rgb(255 255 255 / 10%);">
        <div style="max-width: 600px; margin: 0 auto;">
            <h2 style="color: white; font-size: 2rem; font-weight: bold; margin-bottom: 15px;">
                üìß Stay in the Loop
            </h2>
            <p style="color: rgb(255 255 255 / 80%); font-size: 1.1rem; margin-bottom: 30px;">
                Get exclusive updates on production progress, early-bird deals, and be the first to know when we hit our goals!
            </p>
            
            <div style="display: flex; gap: 10px; max-width: 500px; margin: 0 auto 30px; flex-wrap: wrap; justify-content: center;">
                <input type="email" id="newsletter-email" placeholder="Enter your email address" style="flex: 1; min-width: 250px; padding: 15px 20px; border-radius: 25px; border: 2px solid rgb(0 212 255 / 50%); background: rgb(255 255 255 / 10%); color: white; font-size: 1rem; outline: none;" />
                <button id="newsletter-submit" style="padding: 15px 30px; border-radius: 25px; border: none; background: linear-gradient(45deg, var(--presale-success), #00d4ff); color: white; font-weight: bold; cursor: pointer; font-size: 1rem; transition: all 0.3s ease;">
                    Subscribe ‚Üí
                </button>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-top: 30px;">
                <div style="padding: 15px; background: rgb(255 255 255 / 5%); border-radius: 10px; border: 1px solid rgb(255 255 255 / 10%);">
                    <div style="font-size: 1.5rem; margin-bottom: 5px;">‚ö°</div>
                    <div style="color: rgb(255 255 255 / 90%); font-size: 0.9rem;">Early Access</div>
                </div>
                <div style="padding: 15px; background: rgb(255 255 255 / 5%); border-radius: 10px; border: 1px solid rgb(255 255 255 / 10%);">
                    <div style="font-size: 1.5rem; margin-bottom: 5px;">üí°</div>
                    <div style="color: rgb(255 255 255 / 90%); font-size: 0.9rem;">Progress Updates</div>
                </div>
                <div style="padding: 15px; background: rgb(255 255 255 / 5%); border-radius: 10px; border: 1px solid rgb(255 255 255 / 10%);">
                    <div style="font-size: 1.5rem; margin-bottom: 5px;">üéÅ</div>
                    <div style="color: rgb(255 255 255 / 90%); font-size: 0.9rem;">Exclusive Deals</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Product Development Disclaimer -->
    <section id="disclaimer-section" style="background: rgb(255 255 255 / 5%); padding: 40px 20px; text-align: center; border-bottom: 1px solid rgb(255 255 255 / 10%); scroll-margin-top: 80px;">
        <div style="max-width: 900px; margin: 0 auto;">
            <h3 style="color: rgb(255 255 255 / 90%); font-size: 1.3rem; font-weight: bold; margin-bottom: 20px;">
                ‚ö†Ô∏è Important Product Development Disclaimer
            </h3>
            
            <div style="text-align: left; color: rgb(255 255 255 / 70%); font-size: 0.95rem; line-height: 1.6; padding: 20px; background: rgb(0 0 0 / 30%); border-radius: 10px; border: 1px solid rgb(255 255 255 / 10%);">
                <p style="margin-bottom: 15px;">
                    <strong style="color: rgb(0 212 255);">This is a reservation campaign for products currently in development.</strong> By reserving a DAMP device, you acknowledge and agree to the following:
                </p>
                
                <ul style="list-style-position: inside; margin-bottom: 15px; padding-left: 20px;">
                    <li style="margin-bottom: 10px;">
                        <strong>Production Contingency:</strong> Each product requires a minimum of 500 reservations before manufacturing begins. If a product does not reach its goal, reservations may be refunded or transferred to other products.
                    </li>
                    <li style="margin-bottom: 10px;">
                        <strong>Development Timeline:</strong> Products are currently in the prototype/development phase. Design, features, and specifications may change during final production.
                    </li>
                    <li style="margin-bottom: 10px;">
                        <strong>Estimated Delivery:</strong> Delivery timelines will be provided once production goals are met and manufacturing begins. Delays may occur due to supply chain, quality testing, or manufacturing challenges.
                    </li>
                    <li style="margin-bottom: 10px;">
                        <strong>Product Priority:</strong> Products that reach 500 reservations first will be manufactured and shipped first.
                    </li>
                    <li style="margin-bottom: 10px;">
                        <strong>No Guarantees:</strong> While we are committed to delivering high-quality products, we cannot guarantee specific features, delivery dates, or final product specifications until manufacturing is complete.
                    </li>
                    <li style="margin-bottom: 10px;">
                        <strong>Reservation vs. Purchase:</strong> Your payment secures a reservation spot at early-bird pricing. You are supporting product development and will be first in line for delivery.
                    </li>
                </ul>
                
                <p style="margin-bottom: 15px;">
                    <strong style="color: rgb(255 165 2);">Refund Policy:</strong> If we are unable to manufacture a product due to insufficient reservations, full refunds will be issued. For other refund requests, please contact support@dampdrink.com.
                </p>
                
                <p style="margin-bottom: 20px; font-size: 0.85rem; color: rgb(255 255 255 / 60%);">
                    By completing your reservation, you agree to these terms and acknowledge that you are supporting a product development campaign. Thank you for being an early supporter! üôè
                </p>
                
                <!-- Follow on LinkedIn CTA -->
                <div style="margin-top: 30px; padding: 20px; background: rgb(0 119 181 / 10%); border-radius: 10px; border: 1px solid rgb(0 119 181 / 30%); text-align: center;">
                    <div style="display: inline-flex; align-items: center; gap: 15px; flex-wrap: wrap; justify-content: center;">
                        <div style="font-size: 2rem;">üíº</div>
                        <div style="text-align: left;">
                            <div style="color: white; font-weight: bold; font-size: 1.1rem; margin-bottom: 5px;">
                                Follow Our Journey on LinkedIn
                            </div>
                            <div style="color: rgb(255 255 255 / 70%); font-size: 0.9rem;">
                                Get real-time updates on production milestones, behind-the-scenes content, and exclusive insights
                            </div>
                        </div>
                        <a href="https://www.linkedin.com/company/damp-drink" target="_blank" rel="noopener noreferrer" style="display: inline-flex; align-items: center; gap: 10px; padding: 12px 25px; background: #0077b5; color: white; text-decoration: none; border-radius: 5px; font-weight: bold; transition: all 0.3s ease;" onmouseover="this.style.background='#006399'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='#0077b5'; this.style.transform='translateY(0)'">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/>
                            </svg>
                            Follow DAMP Smart Drinkware
                        </a>
                    </div>
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgb(255 255 255 / 10%);">
                        <div style="display: flex; gap: 25px; justify-content: center; flex-wrap: wrap; font-size: 0.85rem; color: rgb(255 255 255 / 60%);">
                            <div>üìà Production Updates</div>
                            <div>üîß Behind-the-Scenes</div>
                            <div>üéâ Milestone Celebrations</div>
                            <div>ü§ù Partner Announcements</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer" style="background: rgb(0 0 0 / 50%); padding: 40px 20px; text-align: center;">
        <div style="max-width: 800px; margin: 0 auto;">
            <p style="color: rgb(255 255 255 / 70%); margin-bottom: 20px;">
                Questions about your reservation? Email us at
                <a href="mailto:support@dampdrink.com" style="color: var(--presale-success);">support@dampdrink.com</a>
            </p>

            <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-bottom: 20px;">
                <a href="../pages/privacy.html" style="color: rgb(255 255 255 / 60%); text-decoration: none;">Privacy Policy</a>
                <a href="../pages/support.html" style="color: rgb(255 255 255 / 60%); text-decoration: none;">Support</a>
                <a href="../pages/about.html" style="color: rgb(255 255 255 / 60%); text-decoration: none;">About Us</a>
            </div>

            <p style="color: rgb(255 255 255 / 50%); font-size: 0.9rem;">
                &copy; 2025 WeCr8 Solutions LLC. All rights reserved.
            </p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="../assets/js/components/safe-area-wrapper.js"></script>
    <script src="../assets/js/components/header.js"></script>
    <script src="../assets/js/auth-modal.js"></script>

    <!-- Stripe.js is loaded in <head> for early availability -->

    <!-- Pre-Sale Funnel JavaScript -->
    <script>
        // Enhanced Pre-Sale Funnel Controller with Debugging
        class PreSaleFunnel {
            constructor() {
                console.log('üöÄ PreSaleFunnel: Initializing...');
                
                try {
                    this.currentCount = 0; // Starting count - real data only
                    this.goalCount = 0; // No goal limit
                    // Set countdown to 30 days from October 10, 2025
                    this.countdownEndTime = new Date('2025-11-09T23:59:59'); // November 9, 2025 (30 days from Oct 10)

                    // Cart functionality
                    this.cart = {};
                    this.products = {
                        'silicone-bottom': { name: 'DAMP Silicone Bottom', price: 29.99, originalPrice: 39.99 },
                        'damp-handle': { name: 'DAMP Handle v1.0', price: 49.99, originalPrice: 69.99 },
                        'cup-sleeve': { name: 'DAMP Cup Sleeve', price: 34.99, originalPrice: 44.99 }
                    };

                    console.log('üìä PreSaleFunnel: Products loaded:', this.products);
                    console.log('‚è∞ PreSaleFunnel: Countdown end time:', this.countdownEndTime);

                    // Fetch real sales data from Stripe
                    this.fetchRealSalesData();
                    this.startCountdown();
                    this.setupAnalytics();
                    this.setupCartFunctionality();

                    // Setup checkout button
                    const checkoutBtn = document.getElementById('checkout-button');
                    if (checkoutBtn) {
                        checkoutBtn.addEventListener('click', (e) => {
                            e.preventDefault();
                            console.log('üõí PreSaleFunnel: Checkout button clicked');
                            this.initiateCheckout();
                        });
                        console.log('‚úÖ PreSaleFunnel: Checkout button listener attached');
                    } else {
                        console.error('‚ùå PreSaleFunnel: Checkout button not found!');
                    }

                    console.log('‚úÖ PreSaleFunnel: Initialization complete');
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Initialization failed:', error);
                    console.error('Stack trace:', error.stack);
                }
            }

            async fetchRealSalesData() {
                console.log('üìä PreSaleFunnel: Fetching real sales data from Stripe...');
                
                try {
                    // For now, fetch from Netlify function (will implement Stripe webhook data)
                    const response = await fetch('/.netlify/functions/get-sales-stats');
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('‚úÖ PreSaleFunnel: Sales data received:', data);
                        
                        // Update overall counter
                        const currentBackers = document.getElementById('current-backers');
                        if (currentBackers && data.totalSales !== undefined) {
                            currentBackers.textContent = data.totalSales;
                            this.currentCount = data.totalSales;
                        }
                        
                        // Update product-specific counters
                        if (data.productSales) {
                            Object.keys(data.productSales).forEach(productId => {
                                const count = data.productSales[productId];
                                const countElement = document.querySelector(`.product-goal-count[data-product="${productId}"]`);
                                const barElement = document.querySelector(`.product-goal-bar[data-product="${productId}"]`);
                                
                                if (countElement) {
                                    countElement.textContent = count;
                                }
                                
                                if (barElement) {
                                    const percentage = Math.min((count / 500) * 100, 100);
                                    barElement.style.width = `${percentage}%`;
                                }
                                
                                console.log(`üìä Product ${productId}: ${count} / 500 (${percentage.toFixed(1)}%)`);
                            });
                        }
                        
                        // Update progress bar
                        const progressBar = document.getElementById('progress-bar');
                        if (progressBar && data.totalSales !== undefined) {
                            const percentage = Math.min((data.totalSales / 500) * 100, 100);
                            progressBar.style.width = `${percentage}%`;
                        }
                        
                    } else {
                        console.warn('‚ö†Ô∏è PreSaleFunnel: Could not fetch sales data, using 0 as default');
                        // Keep counters at 0
                    }
                } catch (error) {
                    console.warn('‚ö†Ô∏è PreSaleFunnel: Error fetching sales data:', error);
                    // Keep counters at 0
                }
            }

            setupCartFunctionality() {
                console.log('üõí PreSaleFunnel: Setting up cart functionality...');
                
                try {
                    // Quantity controls
                    const qtyBtns = document.querySelectorAll('.qty-btn');
                    console.log(`üî¢ PreSaleFunnel: Found ${qtyBtns.length} quantity buttons`);
                    
                    qtyBtns.forEach((btn, index) => {
                        btn.addEventListener('click', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            e.stopImmediatePropagation();
                            const productId = btn.dataset.product;
                            const isPlus = btn.classList.contains('plus');
                            console.log(`üî¢ PreSaleFunnel: Quantity button clicked - Product: ${productId}, Action: ${isPlus ? 'plus' : 'minus'}`);
                            this.updateQuantity(productId, isPlus ? 1 : -1);
                        });
                    });

                    // Add to cart buttons
                    const addBtns = document.querySelectorAll('.add-to-cart-btn');
                    console.log(`üõí PreSaleFunnel: Found ${addBtns.length} add-to-cart buttons`);
                    
                    addBtns.forEach((btn, index) => {
                        btn.addEventListener('click', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            const productId = btn.dataset.productId;
                            console.log(`üõí PreSaleFunnel: Add to cart button clicked for: ${productId}`);
                            
                            const quantityEl = document.querySelector(`[data-product="${productId}"].quantity`);
                            
                            if (!quantityEl) {
                                console.error(`‚ùå PreSaleFunnel: Quantity element not found for product: ${productId}`);
                                console.log(`üîç PreSaleFunnel: Searching for: [data-product="${productId}"].quantity`);
                                return;
                            }
                            
                            const quantity = parseInt(quantityEl.textContent);
                            console.log(`üõí PreSaleFunnel: Add to cart clicked - Product: ${productId}, Quantity: ${quantity}, Text: ${quantityEl.textContent}`);

                            if (quantity > 0) {
                                this.addToCart(productId, quantity);
                            } else if (this.cart[productId]) {
                                console.log(`üõí PreSaleFunnel: Adding 1 more of existing cart item: ${productId}`);
                                this.addToCart(productId, 1);
                            } else {
                                console.warn(`‚ö†Ô∏è PreSaleFunnel: No quantity selected for product: ${productId}`);
                            }
                        });
                    });

                    // Verify all products are set up correctly and initialize button states
                    const productIds = ['silicone-bottom', 'damp-handle', 'cup-sleeve'];
                    productIds.forEach(productId => {
                        const qtyEl = document.querySelector(`[data-product="${productId}"].quantity`);
                        const addBtn = document.querySelector(`[data-product-id="${productId}"]`);
                        const plusBtn = document.querySelector(`[data-product="${productId}"].plus`);
                        const minusBtn = document.querySelector(`[data-product="${productId}"].minus`);
                        
                        if (!qtyEl || !addBtn || !plusBtn || !minusBtn) {
                            console.error(`‚ùå PreSaleFunnel: Missing elements for ${productId}:`, {
                                hasQuantity: !!qtyEl,
                                hasAddBtn: !!addBtn,
                                hasPlusBtn: !!plusBtn,
                                hasMinusBtn: !!minusBtn
                            });
                        } else {
                            // Initialize button state - disabled until quantity > 0
                            addBtn.disabled = true;
                            addBtn.style.opacity = '0.7';
                            addBtn.style.cursor = 'not-allowed';
                            console.log(`‚úÖ PreSaleFunnel: ${productId} setup complete with disabled add-to-cart button`);
                        }
                    });
                    
                    console.log('‚úÖ PreSaleFunnel: Cart functionality setup complete');
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Cart functionality setup failed:', error);
                }
            }

            updateQuantity(productId, change) {
                console.log(`üî¢ PreSaleFunnel: Updating quantity - Product: ${productId}, Change: ${change}`);
                try {
                    const quantityEl = document.querySelector(`[data-product="${productId}"].quantity`);
                    if (!quantityEl) {
                        console.error(`‚ùå PreSaleFunnel: Quantity element not found for: ${productId}`);
                        return;
                    }
                    
                    // Calculate new quantity
                    let currentQty = parseInt(quantityEl.textContent);
                    if (isNaN(currentQty)) currentQty = 0;
                    let newQty = currentQty + change;
                    if (newQty < 0) newQty = 0;
                    if (newQty > 10) newQty = 10;
                    
                    // Only update if quantity actually changed
                    if (currentQty === newQty) return;
                    
                    // Update quantity display only - minimal DOM manipulation
                    quantityEl.textContent = newQty;
                    console.log(`‚úÖ PreSaleFunnel: Quantity display updated to: ${newQty}`);
                    
                    // Update add to cart button state - only change what's necessary
                    const addBtn = document.querySelector(`[data-product-id="${productId}"]`);
                    if (!addBtn) {
                        console.error(`‚ùå PreSaleFunnel: Add button not found for: ${productId}`);
                        return;
                    }
                    
                    const isInCart = this.cart[productId] && this.cart[productId] > 0;
                    console.log(`üìä PreSaleFunnel: newQty=${newQty}, isInCart=${isInCart}`);
                    
                    // Batch DOM updates to minimize reflows
                    requestAnimationFrame(() => {
                        if (newQty > 0) {
                            addBtn.style.opacity = '1';
                            addBtn.style.cursor = 'pointer';
                            addBtn.textContent = `Add ${newQty} to Cart`;
                            addBtn.disabled = false;
                            console.log(`‚úÖ PreSaleFunnel: Button enabled - "Add ${newQty} to Cart"`);
                        } else if (isInCart) {
                            addBtn.style.opacity = '1';
                            addBtn.style.cursor = 'pointer';
                            addBtn.textContent = 'Add More to Cart';
                            addBtn.disabled = false;
                        } else {
                            addBtn.style.opacity = '0.7';
                            addBtn.style.cursor = 'not-allowed';
                            addBtn.textContent = 'Add to Cart';
                            addBtn.disabled = true;
                        }
                        this.updateCheckoutButton();
                    });
                } catch (error) {
                    console.error(`‚ùå PreSaleFunnel: Error updating quantity for ${productId}:`, error);
                }
            }

            updateCheckoutButton() {
                console.log('üõí PreSaleFunnel: Updating checkout button state...');
                
                try {
                    const checkoutBtn = document.getElementById('checkout-button');
                    if (!checkoutBtn) {
                        console.error('‚ùå PreSaleFunnel: Checkout button not found!');
                        return;
                    }

                    // Check if there are any items in cart with quantity > 0
                    const hasItemsInCart = Object.values(this.cart).some(qty => qty > 0);
                    
                    console.log(`üõí PreSaleFunnel: Checkout state - Items in cart: ${hasItemsInCart}`);
                    console.log(`üõí PreSaleFunnel: Current cart:`, this.cart);

                    if (hasItemsInCart) {
                        checkoutBtn.disabled = false;
                        checkoutBtn.style.opacity = '1';
                        checkoutBtn.style.cursor = 'pointer';

                        if (hasItemsInCart) {
                            const total = Object.entries(this.cart).reduce((sum, [productId, quantity]) => {
                                const product = this.products[productId];
                                if (!product) {
                                    console.error(`‚ùå PreSaleFunnel: Product not found: ${productId}`);
                                    return sum;
                                }
                                return sum + (product.price * quantity);
                            }, 0);
                            checkoutBtn.textContent = `Checkout - $${total.toFixed(2)}`;
                            console.log(`‚úÖ PreSaleFunnel: Checkout button enabled with total: $${total.toFixed(2)}`);
                        } else {
                            checkoutBtn.textContent = 'Add Items to Cart First';
                            console.log('‚ö†Ô∏è PreSaleFunnel: Checkout button shows add items message');
                        }
                    } else {
                        checkoutBtn.disabled = true;
                        checkoutBtn.style.opacity = '0.5';
                        checkoutBtn.style.cursor = 'not-allowed';
                        checkoutBtn.textContent = 'Add Items to Cart First';
                        console.log('‚ùå PreSaleFunnel: Checkout button disabled');
                    }
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error updating checkout button:', error);
                }
            }

            addToCart(productId, quantity) {
                console.log(`üõí PreSaleFunnel: Adding to cart - Product: ${productId}, Quantity: ${quantity}`);
                try {
                    if (quantity <= 0) {
                        console.warn(`‚ö†Ô∏è PreSaleFunnel: Invalid quantity ${quantity} for product ${productId}`);
                        return;
                    }
                    const product = this.products[productId];
                    if (!product) {
                        console.error(`‚ùå PreSaleFunnel: Product not found: ${productId}`);
                        return;
                    }
                    // Add to cart object, max 10 per product
                    const prevQty = this.cart[productId] || 0;
                    let newQty = prevQty + quantity;
                    if (newQty > 10) newQty = 10;
                    this.cart[productId] = newQty;
                    // Reset quantity display
                    const quantityEl = document.querySelector(`[data-product="${productId}"].quantity`);
                    if (quantityEl) quantityEl.textContent = '0';
                    const addBtn = document.querySelector(`[data-product-id="${productId}"]`);
                    if (addBtn) {
                        addBtn.style.opacity = '1';
                        addBtn.style.cursor = 'pointer';
                        addBtn.textContent = 'Add More to Cart';
                        addBtn.disabled = false;
                    }
                    this.updateCartDisplay();
                    this.updateCheckoutButton();
                    const productName = product.name;
                    this.showCartMessage(`‚úÖ Added ${newQty}x ${productName} to cart!`);
                    this.trackAnalytics('add_to_cart', {
                        product_id: productId,
                        quantity: newQty,
                        product_name: productName
                    });
                } catch (error) {
                    console.error(`‚ùå PreSaleFunnel: Error adding ${productId} to cart:`, error);
                }
            }

            removeFromCart(productId, quantityToRemove = null) {
                console.log(`üóëÔ∏è PreSaleFunnel: Removing from cart - Product: ${productId}, Quantity: ${quantityToRemove}`);
                
                try {
                    if (!this.cart[productId]) {
                        console.warn(`‚ö†Ô∏è PreSaleFunnel: Product ${productId} not in cart`);
                        return;
                    }

                    const originalQuantity = this.cart[productId];

                    if (quantityToRemove === null || quantityToRemove >= this.cart[productId]) {
                        delete this.cart[productId];
                        console.log(`üóëÔ∏è PreSaleFunnel: Completely removed ${productId} from cart`);
                    } else {
                        this.cart[productId] -= quantityToRemove;
                        console.log(`üóëÔ∏è PreSaleFunnel: Reduced ${productId} quantity: ${originalQuantity} ‚Üí ${this.cart[productId]}`);
                    }

                    console.log(`üõí PreSaleFunnel: Cart state after removal:`, this.cart);
                    this.updateCartDisplay();
                } catch (error) {
                    console.error(`‚ùå PreSaleFunnel: Error removing ${productId} from cart:`, error);
                }
            }

            updateCartDisplay() {
                console.log('üõí PreSaleFunnel: Updating cart display...');
                
                try {
                    const cartSummary = document.getElementById('cart-summary');
                    const cartItems = document.getElementById('cart-items');
                    const cartItemCount = document.getElementById('cart-item-count');
                    const cartTotal = document.getElementById('cart-total');
                    const cartSavings = document.getElementById('cart-savings');
                    const checkoutBtn = document.getElementById('checkout-button');

                    if (!cartSummary || !cartItems || !cartItemCount || !cartTotal || !cartSavings) {
                        console.error('‚ùå PreSaleFunnel: Cart display elements not found');
                        return;
                    }

                    const totalItems = Object.values(this.cart).reduce((sum, qty) => sum + qty, 0);
                    console.log(`üõí PreSaleFunnel: Total items in cart: ${totalItems}`);

                    if (totalItems === 0) {
                        cartSummary.style.display = 'none';
                        if (checkoutBtn) {
                            checkoutBtn.disabled = true;
                            checkoutBtn.style.opacity = '0.5';
                            checkoutBtn.style.cursor = 'not-allowed';
                            checkoutBtn.textContent = 'Add Items to Cart First';
                        }
                        console.log('üõí PreSaleFunnel: Cart is empty, hiding display');
                        return;
                    }

                    cartSummary.style.display = 'block';
                    console.log('üõí PreSaleFunnel: Showing cart display');

                    let itemsHTML = '';
                    let total = 0;
                    let totalSavings = 0;

                    Object.entries(this.cart).forEach(([productId, quantity]) => {
                        const product = this.products[productId];
                        if (!product) {
                            console.error(`‚ùå PreSaleFunnel: Product not found for cart item: ${productId}`);
                            return;
                        }
                        
                        const itemTotal = product.price * quantity;
                        const itemSavings = (product.originalPrice - product.price) * quantity;

                        total += itemTotal;
                        totalSavings += itemSavings;

                        console.log(`üõí PreSaleFunnel: Cart item ${productId}: ${quantity} √ó $${product.price} = $${itemTotal}`);

                        itemsHTML += `
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <div style="flex: 1;">
                                    <div style="color: white; font-weight: bold;">${product.name}</div>
                                    <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">$${product.price.toFixed(2)} each</div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <button class="cart-qty-btn" onclick="preSaleFunnel.removeFromCart('${productId}', 1)" style="width: 30px; height: 30px; border: none; background: rgba(255,255,255,0.2); color: white; border-radius: 50%; cursor: pointer;">-</button>
                                    <span style="color: white; font-weight: bold; min-width: 20px; text-align: center;">${quantity}</span>
                                    <button class="cart-qty-btn" onclick="preSaleFunnel.addToCart('${productId}', 1)" style="width: 30px; height: 30px; border: none; background: rgba(255,255,255,0.2); color: white; border-radius: 50%; cursor: pointer;">+</button>
                                    <button onclick="preSaleFunnel.removeFromCart('${productId}')" style="background: rgba(255,71,87,0.3); color: #ff4757; border: none; padding: 5px 10px; border-radius: 15px; cursor: pointer; font-size: 0.8rem; margin-left: 10px;">Remove</button>
                                </div>
                                <div style="color: var(--presale-success); font-weight: bold; min-width: 80px; text-align: right;">
                                    $${itemTotal.toFixed(2)}
                                </div>
                            </div>
                        `;
                    });

                    cartItems.innerHTML = itemsHTML;
                    cartItemCount.textContent = totalItems;
                    cartTotal.textContent = total.toFixed(2);
                    cartSavings.textContent = totalSavings.toFixed(2);

                    console.log(`üõí PreSaleFunnel: Cart totals - Items: ${totalItems}, Total: $${total.toFixed(2)}, Savings: $${totalSavings.toFixed(2)}`);

                    if (checkoutBtn) {
                        checkoutBtn.disabled = false;
                        checkoutBtn.style.opacity = '1';
                        checkoutBtn.style.cursor = 'pointer';
                        checkoutBtn.textContent = `Checkout - $${total.toFixed(2)} (Save $${totalSavings.toFixed(2)})`;
                    }

                    console.log('‚úÖ PreSaleFunnel: Cart display updated successfully');
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error updating cart display:', error);
                }
            }

            showCartMessage(message) {
                console.log(`üí¨ PreSaleFunnel: Showing cart message: ${message}`);
                
                try {
                    const messageEl = document.createElement('div');
                    messageEl.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: linear-gradient(45deg, var(--presale-success), #00d4ff);
                        color: white;
                        padding: 15px 25px;
                        border-radius: 10px;
                        font-weight: bold;
                        z-index: 10000;
                        animation: slideInRight 0.3s ease;
                    `;
                    messageEl.textContent = message;
                    document.body.appendChild(messageEl);

                    setTimeout(() => {
                        messageEl.style.animation = 'slideOutRight 0.3s ease';
                        setTimeout(() => messageEl.remove(), 300);
                    }, 3000);

                    console.log('‚úÖ PreSaleFunnel: Cart message displayed');
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error showing cart message:', error);
                }
            }

            updateCounters() {
                console.log(`üìä PreSaleFunnel: Updating counters - Current: ${this.currentCount}, Goal: ${this.goalCount}`);
                
                try {
                    const percentage = (this.currentCount / this.goalCount) * 100;
                    console.log(`üìä PreSaleFunnel: Progress percentage: ${percentage.toFixed(1)}%`);

                    const elements = {
                        'current-backers': this.currentCount,
                        'progress-count': this.currentCount,
                        'final-count': this.currentCount,
                        'final-progress-count': this.currentCount
                    };

                    Object.entries(elements).forEach(([id, value]) => {
                        const element = document.getElementById(id);
                        if (element) {
                            element.textContent = value;
                        } else {
                            console.warn(`‚ö†Ô∏è PreSaleFunnel: Element not found: ${id}`);
                        }
                    });

                    const progressBars = ['progress-bar', 'final-progress-bar'];
                    progressBars.forEach(id => {
                        const element = document.getElementById(id);
                        if (element) {
                            element.style.width = percentage + '%';
                        } else {
                            console.warn(`‚ö†Ô∏è PreSaleFunnel: Progress bar not found: ${id}`);
                        }
                    });

                    if (percentage > 90) {
                        const remaining = this.goalCount - this.currentCount;
                        this.addUrgencyMessage(`üî• Almost sold out! Only ${remaining} spots left!`);
                    } else if (percentage > 80) {
                        const remaining = Math.ceil((this.goalCount - this.currentCount) / 10) * 10;
                        this.addUrgencyMessage(`‚ö° Less than ${remaining} spots remaining!`);
                    }

                    console.log('‚úÖ PreSaleFunnel: Counters updated successfully');
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error updating counters:', error);
                }
            }

            startCountdown() {
                console.log('‚è∞ PreSaleFunnel: Starting countdown timer...');
                
                try {
                    const updateCountdown = () => {
                        const now = new Date().getTime();
                        const distance = this.countdownEndTime.getTime() - now;

                        if (distance < 0) {
                            console.log('‚è∞ PreSaleFunnel: Countdown expired');
                            this.handleCountdownExpired();
                            return;
                        }

                        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                        const timeElements = { days, hours, minutes, seconds };
                        Object.entries(timeElements).forEach(([unit, value]) => {
                            const element = document.getElementById(unit);
                            if (element) {
                                element.textContent = value;
                            }
                        });

                        if (days === 0 && hours < 24) {
                            const timer = document.querySelector('.countdown-timer');
                            if (timer) {
                                timer.style.animation = 'pulse 1s infinite';
                            }
                        }
                    };

                    updateCountdown();
                    const intervalId = setInterval(updateCountdown, 1000);
                    console.log('‚úÖ PreSaleFunnel: Countdown timer started');
                    
                    return intervalId;
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error starting countdown:', error);
                }
            }

            startRealtimeUpdates() {
                console.log('üì° PreSaleFunnel: Starting realtime updates...');
                
                try {
                    const intervalId = setInterval(() => {
                        if (Math.random() < 0.3 && this.currentCount < this.goalCount) {
                            const increment = Math.floor(Math.random() * 2) + 1;
                            this.currentCount += increment;
                            console.log(`üì° PreSaleFunnel: Simulated order - New count: ${this.currentCount} (+${increment})`);
                            this.updateCounters();
                            this.trackAnalytics('simulated_order', { new_count: this.currentCount });
                        }
                    }, 30000);
                    
                    console.log('‚úÖ PreSaleFunnel: Realtime updates started');
                    return intervalId;
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error starting realtime updates:', error);
                }
            }

            async loadLiveActivity() {
                console.log('üì° PreSaleFunnel: Loading live activity...');
                
                try {
                    const response = await fetch('/api/recent-activity');
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: Failed to fetch recent activity`);
                    }

                    const data = await response.json();
                    console.log('üì° PreSaleFunnel: Live activity data:', data);

                    const activityText = data.activity;
                    const elements = ['recent-activity-text', 'final-activity-text'];
                    elements.forEach(id => {
                        const element = document.getElementById(id);
                        if (element) {
                            element.textContent = activityText;
                        }
                    });

                    if (data.currentCount && data.currentCount !== this.currentCount) {
                        console.log(`üì° PreSaleFunnel: Count update from API - ${this.currentCount} ‚Üí ${data.currentCount}`);
                        this.currentCount = data.currentCount;
                        this.updateCounters();
                    }

                    console.log('‚úÖ PreSaleFunnel: Live activity updated successfully');
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error loading live activity:', error);
                    
                    const fallbackMessage = "Join our growing community of early adopters!";
                    const elements = ['recent-activity-text', 'final-activity-text'];
                    elements.forEach(id => {
                        const element = document.getElementById(id);
                        if (element) {
                            element.textContent = fallbackMessage;
                        }
                    });
                }
            }

            startLiveActivityUpdates() {
                console.log('üì° PreSaleFunnel: Starting live activity updates...');
                
                try {
                    this.loadLiveActivity();
                    const intervalId = setInterval(() => {
                        this.loadLiveActivity();
                    }, 30000);
                    
                    console.log('‚úÖ PreSaleFunnel: Live activity updates started');
                    return intervalId;
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error starting live activity updates:', error);
                }
            }

            addUrgencyMessage(message) {
                console.log(`üö® PreSaleFunnel: Adding urgency message: ${message}`);
                
                try {
                    const urgencyEl = document.querySelector('.urgency-message');
                    if (urgencyEl) {
                        urgencyEl.textContent = message;
                        console.log('‚úÖ PreSaleFunnel: Updated existing urgency message');
                    } else {
                        const newUrgency = document.createElement('div');
                        newUrgency.className = 'urgency-message';
                        newUrgency.style.cssText = `
                            background: linear-gradient(45deg, var(--presale-accent), #ff6b6b);
                            color: white;
                            padding: 15px;
                            border-radius: 10px;
                            margin: 20px 0;
                            text-align: center;
                            font-weight: bold;
                            animation: pulse 2s infinite;
                        `;
                        newUrgency.textContent = message;
                        
                        const heroContent = document.querySelector('.hero-content');
                        if (heroContent) {
                            heroContent.appendChild(newUrgency);
                            console.log('‚úÖ PreSaleFunnel: Added new urgency message');
                        } else {
                            console.error('‚ùå PreSaleFunnel: Hero content not found for urgency message');
                        }
                    }
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error adding urgency message:', error);
                }
            }

            handleCountdownExpired() {
                console.log('‚è∞ PreSaleFunnel: Handling countdown expiration...');
                
                try {
                    const timer = document.querySelector('.countdown-timer');
                    if (timer) {
                        timer.innerHTML = `
                            <div style="color: var(--presale-accent); font-weight: bold;">
                                üö® Early Bird Pricing Has Ended
                            </div>
                            <div style="font-size: 0.9rem; margin-top: 10px;">
                                Join waitlist for regular pricing notification
                            </div>
                        `;
                    }

                    document.querySelectorAll('.cta-primary').forEach(btn => {
                        btn.textContent = 'Join Waitlist - $39.99';
                        btn.style.background = 'linear-gradient(45deg, var(--presale-warning), #ffa502)';
                    });

                    console.log('‚úÖ PreSaleFunnel: Countdown expiration handled');
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error handling countdown expiration:', error);
                }
            }

            async initiateCheckout() {
                console.log('üöÄ PreSaleFunnel: Initiating checkout...');
                
                const checkoutButton = document.getElementById('checkout-button');
                const originalText = checkoutButton ? checkoutButton.textContent : 'Checkout';
                
                try {
                    const totalItems = Object.values(this.cart).reduce((sum, qty) => sum + qty, 0);
                    console.log(`üõí PreSaleFunnel: Checkout initiated with ${totalItems} items`);
                    
                    if (totalItems === 0) {
                        console.warn('‚ö†Ô∏è PreSaleFunnel: Checkout attempted with empty cart');
                        alert('Please add items to your cart before checkout.');
                        return;
                    }

                    console.log('üõí PreSaleFunnel: Cart contents for checkout:', this.cart);

                    this.trackAnalytics('checkout_initiated', {
                        count_at_checkout: this.currentCount,
                        time_remaining: this.countdownEndTime.getTime() - new Date().getTime(),
                        cart_items: Object.keys(this.cart).length,
                        cart_total_items: totalItems
                    });

                    if (checkoutButton) {
                        checkoutButton.disabled = true;
                        checkoutButton.textContent = 'üîÑ Creating Checkout Session...';
                        checkoutButton.style.opacity = '0.7';
                    }

                    console.log('üîÑ PreSaleFunnel: Preparing Stripe checkout session...');

                    const lineItems = [];
                    let totalAmount = 0;

                    Object.entries(this.cart).forEach(([productId, quantity]) => {
                        const product = this.products[productId];
                        const itemTotal = product.price * quantity;
                        totalAmount += itemTotal;

                        console.log(`üí∞ PreSaleFunnel: Line item - ${product.name}: ${quantity} √ó $${product.price} = $${itemTotal}`);

                        lineItems.push({
                            price_data: {
                                currency: 'usd',
                                product_data: {
                                    name: product.name,
                                    description: `Pre-order - Early bird pricing`,
                                    images: [`https://dampdrink.com/assets/images/optimized/products/${productId}/${productId}-large.png`]
                                },
                                unit_amount: Math.round(product.price * 100) // Convert to cents
                            },
                            quantity: quantity
                        });
                    });

                    console.log(`üí∞ PreSaleFunnel: Total checkout amount: $${totalAmount.toFixed(2)}`);
                    console.log('üì¶ PreSaleFunnel: Line items prepared:', lineItems);

                    const checkoutData = {
                        line_items: lineItems,
                        mode: 'payment',
                        success_url: `${window.location.origin}/pages/order-success.html?session_id={CHECKOUT_SESSION_ID}`,
                        cancel_url: `${window.location.origin}/pages/pre-sale-funnel.html`,
                        metadata: {
                            campaign: 'presale_funnel',
                            backer_number: this.currentCount + 1,
                            early_bird: 'true',
                            source: 'cart_checkout',
                            cart_items: JSON.stringify(this.cart),
                            total_amount: totalAmount.toFixed(2)
                        },
                        customer_email: null,
                        shipping_address_collection: {
                            allowed_countries: ['US', 'CA', 'GB', 'AU', 'DE', 'FR', 'IT', 'ES', 'NL', 'BE', 'AT', 'CH']
                        }
                    };

                    console.log('üì° PreSaleFunnel: Sending checkout session request...');

                    // Detect local/dev environment (including local network IPs)
                    const hostname = window.location.hostname;
                    const port = window.location.port;
                    const isLocal = hostname === 'localhost' 
                        || hostname === '127.0.0.1'
                        || hostname.startsWith('192.168.')  // Local network
                        || hostname.startsWith('10.')       // Private network A
                        || hostname.startsWith('172.')      // Private network B
                        || port === '8888'                  // Netlify dev default port
                        || port === '3000'                  // Common dev port
                        || port === '8080';                 // Alternative dev port
                    
                    // Determine API endpoint based on environment
                    let apiEndpoint;
                    
                    if (isLocal) {
                        // Try Netlify Dev endpoint first (recommended)
                        if (port === '8888' || confirm('üß™ LOCAL DEV DETECTED\n\nAre you running Netlify Dev?\n\nClick OK if using "netlify dev" (recommended)\nClick Cancel to see setup instructions')) {
                            // Use Netlify Functions endpoint
                            apiEndpoint = `${window.location.protocol}//${hostname}:8888/.netlify/functions/create-checkout-session`;
                            console.log('üì° PreSaleFunnel: Using Netlify Dev endpoint');
                        } else {
                            // Show instructions
                            alert('üß™ LOCAL CHECKOUT TESTING SETUP\n\n' +
                                  'To test Stripe checkout locally:\n\n' +
                                  '1. Stop your current server\n' +
                                  '2. Run: netlify dev\n' +
                                  '3. Open: http://localhost:8888/pages/pre-sale-funnel.html\n' +
                                  '   Or: http://192.168.1.6:8888/pages/pre-sale-funnel.html\n\n' +
                                  'First time setup:\n' +
                                  '‚Ä¢ netlify env:set STRIPE_SECRET_KEY sk_test_YOUR_KEY\n\n' +
                                  'See STRIPE_LOCAL_TESTING_GUIDE.md for details\n\n' +
                                  'Cart contents:\n' + JSON.stringify(this.cart, null, 2) + '\n\nTotal: $' + totalAmount.toFixed(2));
                            
                            if (checkoutButton) {
                                checkoutButton.disabled = false;
                                checkoutButton.textContent = originalText;
                                checkoutButton.style.opacity = '1';
                            }
                            return;
                        }
                    } else {
                        // Production endpoint
                        apiEndpoint = 'https://dampdrink.com/api/create-checkout-session';
                    }
                    console.log(`üì° PreSaleFunnel: Using API endpoint: ${apiEndpoint}`);

                    const response = await fetch(apiEndpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(checkoutData)
                    });

                    console.log(`üì° PreSaleFunnel: Checkout session response status: ${response.status}`);

                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({}));
                        throw new Error(errorData.error || `HTTP ${response.status}: Failed to create checkout session`);
                    }

                    const session = await response.json();
                    console.log('‚úÖ PreSaleFunnel: Checkout session created:', session);

                    if (session.error) {
                        throw new Error(session.error);
                    }

                    console.log('üîê PreSaleFunnel: Initializing Stripe...');
                    const stripe = Stripe('pk_live_51ReW7yCcrIDahSGRjE5nEx9ENwPj8uzAfCJQtmVBkuEyeS7JNq0xscaAqdUFoKos7JO1cKbJXrIscBfUU4yNRQSy00lWo3F7p2');

                    localStorage.setItem('dampPreOrderCart', JSON.stringify(this.cart));
                    console.log('üíæ PreSaleFunnel: Cart saved to localStorage');

                    console.log('üîÑ PreSaleFunnel: Redirecting to Stripe Checkout...');
                    const { error } = await stripe.redirectToCheckout({
                        sessionId: session.sessionId || session.id
                    });

                    if (error) {
                        throw new Error(error.message);
                    }

                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Checkout error:', error);
                    console.error('Stack trace:', error.stack);

                    let errorMessage = 'We\'re experiencing technical difficulties with our payment system.\n\n';

                    if (error.message.includes('404') || error.message.includes('Failed to fetch')) {
                        errorMessage += '‚ùå Our checkout service is temporarily unavailable.\n';
                        errorMessage += 'üîÑ Please try again in a few moments.\n';
                    } else if (error.message.includes('Invalid product')) {
                        errorMessage += '‚ùå One or more selected products are currently unavailable.\n';
                        errorMessage += 'üõí Please review your cart and try again.\n';
                    } else if (error.message.includes('network')) {
                        errorMessage += 'üì° Network connection issue detected.\n';
                        errorMessage += 'üîÑ Please check your internet connection and try again.\n';
                    } else {
                        errorMessage += `‚ùå Error: ${error.message}\n`;
                    }

                    errorMessage += '\nüìß For immediate assistance, contact our support team at support@dampdrink.com';
                    errorMessage += '\nüí¨ Or use the live chat in the bottom-right corner of this page.';

                    alert(errorMessage);

                    const checkoutButton = document.getElementById('checkout-button');
                    if (checkoutButton) {
                        checkoutButton.disabled = false;
                        checkoutButton.textContent = originalText;
                        checkoutButton.style.opacity = '1';
                    }
                }
            }

            setupAnalytics() {
                console.log('üìä PreSaleFunnel: Setting up analytics...');
                
                try {
                    this.trackAnalytics('presale_funnel_view', {
                        current_count: this.currentCount,
                        progress_percentage: (this.currentCount / this.goalCount) * 100
                    });

                    let maxScroll = 0;
                    window.addEventListener('scroll', () => {
                        const scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
                        if (scrollPercent > maxScroll) {
                            maxScroll = scrollPercent;
                            if (maxScroll % 25 === 0) {
                                this.trackAnalytics('scroll_depth', { depth: maxScroll });
                            }
                        }
                    });

                    let timeOnPage = 0;
                    setInterval(() => {
                        timeOnPage += 30;
                        if (timeOnPage % 60 === 0) {
                            this.trackAnalytics('time_on_page', { seconds: timeOnPage });
                        }
                    }, 30000);

                    console.log('‚úÖ PreSaleFunnel: Analytics setup complete');
                } catch (error) {
                    console.error('‚ùå PreSaleFunnel: Error setting up analytics:', error);
                }
            }

            trackAnalytics(event, data = {}) {
                try {
                    if (window.gtag && this.hasAnalyticsConsent()) {
                        console.log(`üìä PreSaleFunnel: Tracking analytics event: ${event}`, data);
                        gtag('event', event, {
                            event_category: 'presale_funnel',
                            event_label: JSON.stringify(data),
                            custom_map: { dimension1: 'presale_conversion' }
                        });
                    } else {
                        console.log(`üìä PreSaleFunnel: Analytics tracking skipped (no consent or gtag): ${event}`);
                    }
                } catch (error) {
                    console.warn('‚ö†Ô∏è PreSaleFunnel: Analytics tracking error:', error);
                }
            }

            hasAnalyticsConsent() {
                const consent = localStorage.getItem('cookieAccepted') === 'true';
                console.log(`üç™ PreSaleFunnel: Analytics consent: ${consent}`);
                return consent;
            }
        }

        // Initialize funnel when DOM is ready
        let preSaleFunnel;
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ DOM Content Loaded - Initializing PreSaleFunnel...');
            try {
                preSaleFunnel = new PreSaleFunnel();
                window.preSaleFunnel = preSaleFunnel; // Make globally available
                console.log('‚úÖ PreSaleFunnel initialized and available globally');
                
                // Debug: Test if buttons are clickable
                setTimeout(() => {
                    console.log('üß™ Running button diagnostics...');
                    const testBtn = document.querySelector('.qty-btn.plus');
                    if (testBtn) {
                        console.log('‚úÖ Found plus button:', testBtn);
                        console.log('   - data-product:', testBtn.dataset.product);
                        console.log('   - classList:', Array.from(testBtn.classList));
                        console.log('   - computed style display:', window.getComputedStyle(testBtn).display);
                        console.log('   - pointer-events:', window.getComputedStyle(testBtn).pointerEvents);
                    } else {
                        console.error('‚ùå Could not find .qty-btn.plus');
                    }
                    
                    const quantityEl = document.querySelector('.quantity[data-product="silicone-bottom"]');
                    if (quantityEl) {
                        console.log('‚úÖ Found quantity element:', quantityEl.textContent);
                    }
                }, 1000);
            } catch (error) {
                console.error('‚ùå Failed to initialize PreSaleFunnel:', error);
                console.error('Stack trace:', error.stack);
            }
        });
        
        // Manual test function - call from console: testProductCard()
        window.testProductCard = function() {
            console.log('üß™ MANUAL TEST: Testing product card functionality...');
            
            const productId = 'silicone-bottom';
            const card = document.querySelector(`[data-product-id="${productId}"]`);
            const quantityEl = document.querySelector(`[data-product="${productId}"].quantity`);
            const plusBtn = document.querySelector(`[data-product="${productId}"].plus`);
            const minusBtn = document.querySelector(`[data-product="${productId}"].minus`);
            const addBtn = document.querySelector(`[data-product-id="${productId}"]`);
            
            console.log('Elements found:', {
                card: !!card,
                quantityEl: !!quantityEl,
                plusBtn: !!plusBtn,
                minusBtn: !!minusBtn,
                addBtn: !!addBtn
            });
            
            if (card) console.log('Card display:', window.getComputedStyle(card).display);
            if (quantityEl) console.log('Current quantity:', quantityEl.textContent, 'Display:', window.getComputedStyle(quantityEl).display);
            if (addBtn) console.log('Add button text:', addBtn.textContent);
            
            // Try clicking plus button programmatically
            if (plusBtn) {
                console.log('üñ±Ô∏è Simulating plus button click...');
                plusBtn.click();
                setTimeout(() => {
                    console.log('After click - quantity:', quantityEl ? quantityEl.textContent : 'MISSING!');
                    console.log('After click - quantity display:', quantityEl ? window.getComputedStyle(quantityEl).display : 'MISSING!');
                    console.log('After click - add button:', addBtn ? addBtn.textContent : 'MISSING!');
                    console.log('After click - add button disabled:', addBtn ? addBtn.disabled : 'MISSING!');
                    console.log('After click - plusBtn still exists:', !!document.querySelector(`[data-product="${productId}"].plus`));
                }, 100);
            }
        };

        // Enhanced smooth scrolling with debugging
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const target = document.querySelector(targetId);
                
                console.log(`üîó Smooth scroll triggered for: ${targetId}`);
                
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    console.log(`‚úÖ Smooth scroll completed for: ${targetId}`);
                } else {
                    console.warn(`‚ö†Ô∏è Scroll target not found: ${targetId}`);
                }
            });
        });

        // Newsletter signup functionality
        const newsletterSubmit = document.getElementById('newsletter-submit');
        const newsletterEmail = document.getElementById('newsletter-email');
        
        if (newsletterSubmit && newsletterEmail) {
            newsletterSubmit.addEventListener('click', async function() {
                const email = newsletterEmail.value.trim();
                
                // Basic email validation
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!email || !emailRegex.test(email)) {
                    alert('‚ö†Ô∏è Please enter a valid email address.');
                    newsletterEmail.focus();
                    return;
                }
                
                // Disable button and show loading state
                const originalText = newsletterSubmit.textContent;
                newsletterSubmit.textContent = 'Subscribing...';
                newsletterSubmit.disabled = true;
                newsletterSubmit.style.opacity = '0.7';
                
                try {
                    console.log('üìß Newsletter signup:', email);
                    
                    // TODO: Integrate with your email service (Mailchimp, SendGrid, etc.)
                    // For now, we'll simulate success
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    // Success feedback
                    newsletterSubmit.textContent = '‚úÖ Subscribed!';
                    newsletterSubmit.style.background = 'linear-gradient(45deg, #10b981, #059669)';
                    newsletterEmail.value = '';
                    
                    // Show success message
                    alert('üéâ Thank you for subscribing! You\'ll be the first to know about production updates and exclusive deals.');
                    
                    // Reset button after 3 seconds
                    setTimeout(() => {
                        newsletterSubmit.textContent = originalText;
                        newsletterSubmit.disabled = false;
                        newsletterSubmit.style.opacity = '1';
                        newsletterSubmit.style.background = 'linear-gradient(45deg, var(--presale-success), #00d4ff)';
                    }, 3000);
                    
                } catch (error) {
                    console.error('‚ùå Newsletter signup error:', error);
                    newsletterSubmit.textContent = '‚ùå Error';
                    alert('‚ö†Ô∏è There was an error subscribing. Please try again or email us directly at support@dampdrink.com');
                    
                    // Reset button after 2 seconds
                    setTimeout(() => {
                        newsletterSubmit.textContent = originalText;
                        newsletterSubmit.disabled = false;
                        newsletterSubmit.style.opacity = '1';
                    }, 2000);
                }
            });
            
            // Allow Enter key to submit
            newsletterEmail.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    newsletterSubmit.click();
                }
            });
        }

        // Global error handling
        window.addEventListener('error', (event) => {
            console.error('üö® Global JavaScript Error:', {
                message: event.message,
                filename: event.filename,
                lineno: event.lineno,
                colno: event.colno,
                error: event.error
            });
        });

        window.addEventListener('unhandledrejection', (event) => {
            console.error('üö® Unhandled Promise Rejection:', event.reason);
        });

        console.log('‚úÖ PreSaleFunnel script loaded successfully');
    </script>

    <!-- Cookie Notice -->
    <div class="cookie-notice" id="cookieNotice" style="position: fixed; bottom: 20px; left: 20px; right: 20px; background: rgb(15 15 35 / 95%); backdrop-filter: blur(20px); border-radius: 10px; padding: 15px; color: white; font-size: 0.9rem; z-index: 1000; display: none;">
        üç™ We use cookies to track reservation progress and improve your experience.
        <a href="../pages/privacy.html" style="color: var(--presale-success);">Privacy Policy</a>
        <button onclick="acceptCookies()" style="background: var(--presale-success); color: white; border: none; padding: 8px 15px; border-radius: 5px; margin-left: 10px; cursor: pointer;">Accept</button>
    </div>

    <script>
        function acceptCookies() {
            document.getElementById('cookieNotice').style.display = 'none';
            localStorage.setItem('cookieAccepted', 'true');

            // Initialize analytics after consent
            if (window.gtag) {
                gtag('consent', 'update', {
                    'analytics_storage': 'granted'
                });
                gtag('event', 'page_view', {
                    page_title: document.title,
                    page_location: window.location.href
                });
            }
        }

        // Show cookie notice if not accepted
        if (!localStorage.getItem('cookieAccepted')) {
            setTimeout(() => {
                document.getElementById('cookieNotice').style.display = 'block';
            }, 3000);
        }
    </script>

    <!-- PWA Service Worker Registration -->
    <script>
        // Google PWA Standards Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    // First, unregister any existing service workers with errors
                    const existingRegistrations = await navigator.serviceWorker.getRegistrations();
                    for (let registration of existingRegistrations) {
                        await registration.unregister();
                        console.log('üóëÔ∏è Unregistered old service worker');
                    }
                    
                    // Clear all caches
                    const cacheNames = await caches.keys();
                    for (let cacheName of cacheNames) {
                        await caches.delete(cacheName);
                        console.log('üóëÔ∏è Deleted cache:', cacheName);
                    }
                    
                    // Now register the fixed service worker
                    const registration = await navigator.serviceWorker.register('/sw.js', {
                        scope: '/',
                        updateViaCache: 'none'
                    });
                    console.log('‚úÖ Service Worker registered:', registration.scope);

                    // Handle updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                showUpdateNotification();
                            }
                        });
                    });

                    window.dampPWA = { registration };
                } catch (error) {
                    console.error('‚ùå Service Worker failed:', error);
                }
            });
        }

        function showUpdateNotification() {
            const notification = document.createElement('div');
            notification.innerHTML = '<div style="position:fixed;top:20px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#00d4ff,#00ff88);color:#1a1a2e;padding:15px 25px;border-radius:30px;font-weight:600;z-index:10000;display:flex;align-items:center;gap:15px;"><span>üöÄ</span><span>New version available!</span><button onclick="refreshApp()" style="background:rgba(26,26,46,0.2);color:#1a1a2e;border:none;padding:8px 16px;border-radius:20px;font-weight:600;cursor:pointer;">Update</button><button onclick="this.parentElement.parentElement.remove()" style="background:transparent;border:none;color:#1a1a2e;cursor:pointer;padding:5px;">√ó</button></div>';
            document.body.appendChild(notification);
        }

        function refreshApp() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistration().then(registration => {
                    if (registration && registration.waiting) {
                        registration.waiting.postMessage({ type: 'SKIP_WAITING' });
                        window.location.reload();
                    }
                });
            }
        }

        // Load Mobile App Redirect Script
        const mobileAppScript = document.createElement('script');
        mobileAppScript.src = '/assets/js/mobile-app-redirect.js';
        mobileAppScript.async = true;
        document.head.appendChild(mobileAppScript);
    </script>
    
    <!-- Debug & Testing Tools -->
    <script src="../assets/js/debug-logger.js"></script>
    <script src="../assets/js/smoke-test.js"></script>
</body>
</html>